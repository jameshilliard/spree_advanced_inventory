
<div data-hook="admin_purchase_order_form_fields">
  <div class="alpha eighteen columns omega">
    <div class="eight columns alpha">
      <fieldset data-hook="purchase-order-line-items" class="no-border-bottom">
        <legend align="center">
          <%= @purchase_order.dropship ? t(:line_item) : t(:line_items) %>
        </legend>
        
        <%= render partial: "spree/admin/shared/add_purchase_order_product" %>
      </fieldset> 

      <div class="clear"></div>

      
      <% if @purchase_order.purchase_order_line_items.size > 0 %>
        <fieldset data-hook="purchase-order-line-items" class="no-border-bottom">
          <legend align="center">
            <%= t(:existing_line_items) %>
          </legend>
        </fieldset>

        <div id="purchase-order-line-items">
          <%= render partial: "purchase_order_line_item/inline_edit", 
            collection: @purchase_order.purchase_order_line_items,
            as: :line_item,
            locals: { f: f, po: @purchase_order }
          %>
        </div>
      <% end %>
                 
    </div>


    <div class="eight columns omega">
      <fieldset data-hook="purchase-order-details" class=" no-border-bottom">
        <legend align="center">
          <%= t(:shipping) %>
        </legend>

        <% if @purchase_order.dropship %>
          <%= render partial: "spree/admin/shared/purchase_order_address", locals: { f: f } %>

        <% else %>
          <%= f.hidden_field :address_id, value: @office_address.id %>
          <%= @office_address %>

        <% end %>

      </fieldset>

      <fieldset data-hook="purchase-order-details" class=" no-border-bottom">
        <legend align="center">
          <%= t(:other_details) %>
        </legend>
          

        <div data-hook="purchase_order_due_at" class="field">
          <%= f.label :due_at, t(:date_needed_by) %> 
          <br/>
          <%= f.text_field :due_at, 
            value: datepicker_field_value(@purchase_order.due_at), 
            class: 'datepicker datepicker-from fullwidth' %>
        </div>


        <div data-hook="purchase_order_adjustments" class="field">
          <%= f.label :adjustments, t(:balance_adjustments) %>
          <div class="clear"></div>

          <div class="three columns alpha">
            <%= f.text_field :discount, 
              class: 'fullwidth', 
                placeholder: "Discount" %>
          </div>
          <div class="three columns">
            <%= f.text_field :shipping, 
              class: 'fullwidth', 
                placeholder: "Shipping" %>
          </div>
          <div class="two columns omega">
            <%= f.text_field :deposit,
              class: 'fullwidth', 
                placeholder: "Deposit" %>
           </div>
           <div class="clear"></div>
        </div>

        <div data-hook="purchase_order_supplier_id" class="field">
          <%= f.label :supplier_id, t(:supplier) %> 
          <%= f.collection_select :supplier_id, 
            Spree::Supplier.order("name asc"), 
            :id, 
            :name, 
            {},  
            {class: 'fullwidth' } %>
        </div>



        
      </fieldset>
    </div>

  </div>
</div>

<script>
  $("#purchase_order_supplier_id").select2();
  $("#purchase_order_shipping_method_id").select2();
  $("#purchase_order_address_id").select2();
  $("#purchase_order_status").select2();
  
</script>

<% content_for :head do %>
  <%= javascript_tag 'var expand_variants = true;' %>
<% end %>

